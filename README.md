Quick Python conversion. Needs refactoring.
